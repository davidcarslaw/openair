<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Calculate a range of air pollution-relevant statistics by year."><title>Calculate summary statistics for air pollution data by year — aqStats • openair</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Calculate summary statistics for air pollution data by year — aqStats"><meta property="og:description" content="Calculate a range of air pollution-relevant statistics by year."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-default navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">openair</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.10-0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Functions</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">News</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/davidcarslaw/openair">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Calculate summary statistics for air pollution data by year</h1>
      <small class="dont-index">Source: <a href="https://github.com/davidcarslaw/openair/blob/HEAD/R/aqStats.R" class="external-link"><code>R/aqStats.R</code></a></small>
      <div class="d-none name"><code>aqStats.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Calculate a range of air pollution-relevant statistics by year.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">aqStats</span><span class="op">(</span>
  <span class="va">mydata</span>,
  pollutant <span class="op">=</span> <span class="st">"no2"</span>,
  type <span class="op">=</span> <span class="st">"default"</span>,
  data.thresh <span class="op">=</span> <span class="fl">0</span>,
  percentile <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">95</span>, <span class="fl">99</span><span class="op">)</span>,
  transpose <span class="op">=</span> <span class="cn">FALSE</span>,
  <span class="va">...</span>
<span class="op">)</span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>mydata</dt>
<dd><p>A data frame containing a <code>date</code> field of hourly data.</p></dd>


<dt>pollutant</dt>
<dd><p>The name of a pollutant e.g. <code>pollutant = c("o3",
"pm10")</code>.</p></dd>


<dt>type</dt>
<dd><p><code>type</code> allows <code>timeAverage</code> to be applied to
cases where there are groups of data that need to be split and
the function applied to each group. The most common example is
data with multiple sites identified with a column representing
site name e.g. <code>type = "site"</code>. More generally, <code>type</code>
should be used where the date repeats for a particular grouping
variable.</p></dd>


<dt>data.thresh</dt>
<dd><p>The data capture threshold in <!-- %. No values are calculated -->
if data capture over the period of interest is less than this value.
<code>data.thresh</code> is used for example in the calculation of daily mean
values from hourly data. If there are less than <code>data.thresh</code>
percentage of measurements available in a period, <code>NA</code> is returned.</p></dd>


<dt>percentile</dt>
<dd><p>Percentile values to calculate for each pollutant.</p></dd>


<dt>transpose</dt>
<dd><p>The default is to return a data frame with columns
representing the statistics. If <code>transpose = TRUE</code> then the results
have columns for each pollutant-site combination.</p></dd>


<dt>...</dt>
<dd><p>Other arguments, currently unused.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>This function calculates a range of common and air pollution-specific
statistics from a data frame. The statistics are calculated on an annual
basis and the input is assumed to be hourly data. The function can cope with
several sites and years e.g. using <code>type = "site"</code>. The user can control the output by setting
<code>transpose</code> appropriately.</p>
<p>Note that the input data is assumed to be in mass units e.g. ug/m3 for all
species except CO (mg/m3).</p>
<p>The following statistics are calculated:</p>
<ul><li><p><b>data.capture</b> --- percentage data capture over a full
year.</p></li>
<li><p><b>mean</b> --- annual mean.</p></li>
<li><p><b>minimum</b> --- minimum hourly value.</p></li>
<li><p><b>maximum</b> --- maximum hourly value.</p></li>
<li><p><b>median</b> --- median value.</p></li>
<li><p><b>max.daily</b> --- maximum daily mean.</p></li>
<li><p><b>max.rolling.8</b> --- maximum 8-hour rolling mean.</p></li>
<li><p><b>max.rolling.24</b> --- maximum 24-hour rolling mean.</p></li>
<li><p><b>percentile.95</b> --- 95th percentile. Note that several
percentiles can be calculated.</p></li>
<li><p><b>roll.8.O3.gt.100</b> --- number of days when the daily maximum
rolling 8-hour mean ozone concentration is &gt;100 ug/m3. This is the target
value.</p></li>
<li><p><b>roll.8.O3.gt.120</b> --- number of days when the daily maximum
rolling 8-hour mean ozone concentration is &gt;120 ug/m3. This is the Limit
Value not to be exceeded &gt; 10 days a year.</p></li>
<li><p><b>AOT40</b> --- is the accumulated amount of ozone over the threshold
value of 40 ppb for daylight hours in the growing season (April to
September). Note that <code>latitude</code> and <code>longitude</code> can also be
passed to this calculation.</p></li>
<li><p><b>hours.gt.200</b> --- number of hours NO2 is more than 200 ug/m3.</p></li>
<li><p><b>days.gt.50</b> --- number of days PM10 is more than 50 ug/m3.</p></li>
</ul><p>For the rolling means, the user can supply the option <code>align</code>, which
can be "centre" (default), "left" or "right". See <code>rollingMean</code> for
more details.</p>
<p>There can be small discrepancies with the AURN due to the treatment of
rounding data. The <code>aqStats</code> function does not round, whereas AURN data
can be rounded at several stages during the calculations.</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>David Carslaw</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"></span>
<span class="r-in"><span class="co">## Statistics for 2004. NOTE! these data are in ppb/ppm so the</span></span>
<span class="r-in"><span class="co">## example is for illustrative purposes only</span></span>
<span class="r-in"><span class="fu">aqStats</span><span class="op">(</span><span class="fu"><a href="selectByDate.html">selectByDate</a></span><span class="op">(</span><span class="va">mydata</span>, year <span class="op">=</span> <span class="fl">2004</span><span class="op">)</span>, pollutant <span class="op">=</span> <span class="st">"no2"</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 1 × 14</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># Groups:   default [1]</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   default    year date                dat.cap  mean   min   max median max_daily</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dttm&gt;</span>                <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span> 01 Janua…  <span style="text-decoration: underline;">2</span>004 2004-01-01 <span style="color: #949494;">00:00:00</span>    99.8  55.0     0   185     51      106.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># … with 5 more variables: roll_8_max &lt;dbl&gt;, roll_24_max &lt;dbl&gt;,</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;">#   percentile.95 &lt;dbl&gt;, percentile.99 &lt;dbl&gt;, hours &lt;int&gt;</span></span>
<span class="r-in"></span>
<span class="r-in"></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by David Carslaw, Karl Ropkins.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.4.</p>
</div>

    </footer></div>

  

  

  </body></html>

