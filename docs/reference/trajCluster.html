<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="This function carries out cluster analysis of HYSPLIT back
trajectories. The function is specifically designed to work with
the trajectories imported using the openair
importTraj function, which provides pre-calculated back
trajectories at specific receptor locations."><title>Calculate clusters for back tracectories — trajCluster • openair</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Calculate clusters for back tracectories — trajCluster"><meta property="og:description" content="This function carries out cluster analysis of HYSPLIT back
trajectories. The function is specifically designed to work with
the trajectories imported using the openair
importTraj function, which provides pre-calculated back
trajectories at specific receptor locations."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-default navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">openair</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.8-6</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Functions</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">News</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/davidcarslaw/openair">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Calculate clusters for back tracectories</h1>
      <small class="dont-index">Source: <a href="https://github.com/davidcarslaw/openair/blob/HEAD/R/trajCluster.R" class="external-link"><code>R/trajCluster.R</code></a></small>
      <div class="d-none name"><code>trajCluster.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function carries out cluster analysis of HYSPLIT back
trajectories. The function is specifically designed to work with
the trajectories imported using the <code>openair</code>
<code>importTraj</code> function, which provides pre-calculated back
trajectories at specific receptor locations.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">trajCluster</span><span class="op">(</span>
  <span class="va">traj</span>,
  method <span class="op">=</span> <span class="st">"Euclid"</span>,
  n.cluster <span class="op">=</span> <span class="fl">5</span>,
  plot <span class="op">=</span> <span class="cn">TRUE</span>,
  type <span class="op">=</span> <span class="st">"default"</span>,
  cols <span class="op">=</span> <span class="st">"Set1"</span>,
  split.after <span class="op">=</span> <span class="cn">FALSE</span>,
  map.fill <span class="op">=</span> <span class="cn">TRUE</span>,
  map.cols <span class="op">=</span> <span class="st">"grey40"</span>,
  map.alpha <span class="op">=</span> <span class="fl">0.4</span>,
  projection <span class="op">=</span> <span class="st">"lambert"</span>,
  parameters <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">51</span>, <span class="fl">51</span><span class="op">)</span>,
  orientation <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">90</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>,
  by.type <span class="op">=</span> <span class="cn">FALSE</span>,
  origin <span class="op">=</span> <span class="cn">TRUE</span>,
  <span class="va">...</span>
<span class="op">)</span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>traj</dt>
<dd><p>An openair trajectory data frame resulting from the
use of <code>importTraj</code>.</p></dd>
<dt>method</dt>
<dd><p>Method used to calculate the distance matrix for the
back trajectories. There are two methods available:
“Euclid” and “Angle”.</p></dd>
<dt>n.cluster</dt>
<dd><p>Number of clusters to calculate.</p></dd>
<dt>plot</dt>
<dd><p>Should a plot be produced?</p></dd>
<dt>type</dt>
<dd><p><code>type</code> determines how the data are split i.e.
conditioned, and then plotted. The default is will produce a
single plot using the entire data. Type can be one of the
built-in types as detailed in <code>cutData</code> e.g.
“season”, “year”, “weekday” and so on. For
example, <code>type = "season"</code> will produce four plots --- one
for each season. Note that the cluster calculations are
separately made of each level of "type".</p></dd>
<dt>cols</dt>
<dd><p>Colours to be used for plotting. Options include
“default”, “increment”, “heat”,
“jet” and <code>RColorBrewer</code> colours --- see the
<code>openair</code> <code>openColours</code> function for more details. For
user defined the user can supply a list of colour names
recognised by R (type <code><a href="https://rdrr.io/r/grDevices/colors.html" class="external-link">colours()</a></code> to see the full list). An
example would be <code>cols = c("yellow", "green", "blue")</code></p></dd>
<dt>split.after</dt>
<dd><p>For <code>type</code> other than “default”
e.g. “season”, the trajectories can either be calculated
for each level of <code>type</code> independently or extracted after
the cluster calculations have been applied to the whole data
set.</p></dd>
<dt>map.fill</dt>
<dd><p>Should the base map be a filled polygon? Default
is to fill countries.</p></dd>
<dt>map.cols</dt>
<dd><p>If <code>map.fill = TRUE</code> <code>map.cols</code> controls
the fill colour. Examples include <code>map.fill = "grey40"</code> and
<code>map.fill = openColours("default", 10)</code>. The latter colours
the countries and can help differentiate them.</p></dd>
<dt>map.alpha</dt>
<dd><p>The transpency level of the filled map which
takes values from 0 (full transparency) to 1 (full opacity).
Setting it below 1 can help view trajectories, trajectory
surfaces etc. <em>and</em> a filled base map.</p></dd>
<dt>projection</dt>
<dd><p>The map projection to be used. Different map
projections are possible through the <code>mapproj</code> package.
See<code>?mapproject</code> for extensive details and information on
setting other parameters and orientation (see below).</p></dd>
<dt>parameters</dt>
<dd><p>From the <code>mapproj</code> package. Optional
numeric vector of parameters for use with the projection
argument. This argument is optional only in the sense that
certain projections do not require additional parameters. If a
projection does require additional parameters, these must be
given in the parameters argument.</p></dd>
<dt>orientation</dt>
<dd><p>From the <code>mapproj</code> package. An optional
vector c(latitude,longitude,rotation) which describes where the
"North Pole" should be when computing the projection. Normally
this is c(90,0), which is appropriate for cylindrical and conic
projections. For a planar projection, you should set it to the
desired point of tangency. The third value is a clockwise
rotation (in degrees), which defaults to the midrange of the
longitude coordinates in the map.</p></dd>
<dt>by.type</dt>
<dd><p>The percentage of the total number of trajectories
is given for all data by default. Setting <code>by.type = TRUE</code>
will make each panel add up to 100.</p></dd>
<dt>origin</dt>
<dd><p>If <code>TRUE</code> a filled circle dot is shown to mark the
receptor point.</p></dd>
<dt>...</dt>
<dd><p>Other graphical parameters passed onto
<code>lattice:levelplot</code> and <code>cutData</code>. Similarly, common
axis and title labelling options (such as <code>xlab</code>,
<code>ylab</code>, <code>main</code>) are passed to <code>levelplot</code> via
<code>quickText</code> to handle routine formatting.</p></dd>
</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>Returns a list with two data components. The first
  (<code>data</code>) contains the orginal data with the cluster
  identified. The second (<code>results</code>) contains the data used
  to plot the clustered trajectories.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Two main methods are available to cluster the back trajectories
using two different calculations of the distance matrix. The
default is to use the standard Euclidian distance between each
pair of trajectories. Also available is an angle-based distance
matrix based on Sirois and Bottenheim (1995). The latter method is
useful when the interest is the direction of the trajectories in
clustering.</p>
<p>The distance matrix calculations are made in C++ for speed. For
data sets of up to 1 year both methods should be relatively fast,
although the <code>method = "Angle"</code> does tend to take much longer
to calculate. Further details of these methods are given in the
openair manual.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Sirois, A. and Bottenheim, J.W., 1995. Use of backward
trajectories to interpret the 5-year record of PAN and O3 ambient
air concentrations at Kejimkujik National Park, Nova
Scotia. Journal of Geophysical Research, 100: 2867-2881.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="importTraj.html">importTraj</a></code>, <code><a href="trajPlot.html">trajPlot</a></code>,
  <code><a href="trajLevel.html">trajLevel</a></code></p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>David Carslaw</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span>
<span class="r-in"><span class="co">## import trajectories</span></span>
<span class="r-in"><span class="va">traj</span> <span class="op">&lt;-</span> <span class="fu"><a href="importTraj.html">importTraj</a></span><span class="op">(</span>site <span class="op">=</span> <span class="st">"london"</span>, year <span class="op">=</span> <span class="fl">2009</span><span class="op">)</span></span>
<span class="r-in"><span class="co">## calculate clusters</span></span>
<span class="r-in"><span class="va">clust</span> <span class="op">&lt;-</span> <span class="fu">trajCluster</span><span class="op">(</span><span class="va">traj</span>, n.cluster <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">clust</span><span class="op">$</span><span class="va">data</span><span class="op">)</span> <span class="co">## note new variable 'cluster'</span></span>
<span class="r-in"><span class="co">## use different distance matrix calculation, and calculate by season</span></span>
<span class="r-in"><span class="va">traj</span> <span class="op">&lt;-</span> <span class="fu">trajCluster</span><span class="op">(</span><span class="va">traj</span>, method <span class="op">=</span> <span class="st">"Angle"</span>, type <span class="op">=</span> <span class="st">"season"</span>, n.cluster <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span>
<span class="r-in"><span class="op">}</span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by David Carslaw, Karl Ropkins.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a>
2.0.2.</p>
</div>

    </footer></div>

  

  

  </body></html>

