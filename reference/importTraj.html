<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Function to import pre-calculated back trajectories using the NOAA HYSPLIT
model. The trajectories have been calculated for a select range of locations
which will expand in time. They cover the last 20 years or so and can be used
together with other openair functions."><title>Import pre-calculated HYSPLIT 96-hour back trajectories — importTraj • openair</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Import pre-calculated HYSPLIT 96-hour back trajectories — importTraj"><meta property="og:description" content="Function to import pre-calculated back trajectories using the NOAA HYSPLIT
model. The trajectories have been calculated for a select range of locations
which will expand in time. They cover the last 20 years or so and can be used
together with other openair functions."><meta property="og:image" content="https://davidcarslaw.github.io/openair/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-default navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">openair</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.15.0.9001</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Functions</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">News</a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://bookdown.org/david_carslaw/openair/">Book</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/davidcarslaw/openair">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Import pre-calculated HYSPLIT 96-hour back trajectories</h1>
      <small class="dont-index">Source: <a href="https://github.com/davidcarslaw/openair/blob/HEAD/R/importTraj.R" class="external-link"><code>R/importTraj.R</code></a></small>
      <div class="d-none name"><code>importTraj.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Function to import pre-calculated back trajectories using the NOAA HYSPLIT
model. The trajectories have been calculated for a select range of locations
which will expand in time. They cover the last 20 years or so and can be used
together with other <code>openair</code> functions.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">importTraj</span><span class="op">(</span>site <span class="op">=</span> <span class="st">"london"</span>, year <span class="op">=</span> <span class="fl">2009</span>, local <span class="op">=</span> <span class="cn">NA</span>, progress <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>site</dt>
<dd><p>Site code of the network site to import e.g. "london". Only one
site can be imported at a time. The following sites are typically available
from 2000-2012, although some UK ozone sites go back to 1988 (code,
location, lat, lon, year):</p></dd>


<dt>year</dt>
<dd><p>Year or years to import. To import a sequence of years from
1990 to 2000 use <code>year = 1990:2000</code>. To import several specific years
use <code>year = c(1990, 1995, 2000)</code> for example.</p></dd>


<dt>local</dt>
<dd><p>File path to .RData trajectory files run by user and
not stored on the Ricardo web server. These files would have been
generated from the Hysplit trajectory code shown in the appendix
of the openair manual. An example would be <code>local =
'c:/users/david/TrajFiles/'</code>.</p></dd>


<dt>progress</dt>
<dd><p>Show a progress bar when many receptors/years are being
imported? Defaults to <code>TRUE</code>.</p>
<table class="table table"><tr><td>abudhabi</td><td>Abu Dhabi</td><td>24.43000</td><td>54.408000</td><td>2012-2013</td></tr><tr><td>ah</td><td>Aston Hill</td><td>52.50385</td><td>-3.041780</td><td>1988-2013</td></tr><tr><td>auch</td><td>Auchencorth Moss</td><td>55.79283</td><td>-3.242568</td><td>2006-2013</td></tr><tr><td>berlin</td><td>Berlin, Germany</td><td>52.52000</td><td>13.400000</td><td>2000-2013</td></tr><tr><td>birm</td><td>Birmigham Centre</td><td>52.47972</td><td>-1.908078</td><td>1990-2013</td></tr><tr><td>boston</td><td>Boston, USA</td><td>42.32900</td><td>-71.083000</td><td>2008-2013</td></tr><tr><td>bot</td><td>Bottesford</td><td>52.93028</td><td>-0.814722</td><td>1990-2013</td></tr><tr><td>bukit</td><td>Bukit Kototabang, Indonesia</td><td>-0.19805</td><td>100.318000</td><td>1996-2013</td></tr><tr><td>chittagong</td><td>Chittagong, Bangladesh</td><td>22.37000</td><td>91.800000</td><td>2010-2013</td></tr><tr><td>dhaka</td><td>Dhaka, Bangladesh</td><td>23.70000</td><td>90.375000</td><td>2010-2013</td></tr><tr><td>ed</td><td>Edinburgh</td><td>55.95197</td><td>-3.195775</td><td>1990-2013</td></tr><tr><td>elche</td><td>Elche, Spain</td><td>38.27000</td><td>-0.690000</td><td>2004-2013</td></tr><tr><td>esk</td><td>Eskdalemuir</td><td>55.31530</td><td>-3.206110</td><td>1998-2013</td></tr><tr><td>gibraltar</td><td>Gibraltar</td><td>36.13400</td><td>-5.347000</td><td>2005-2010</td></tr><tr><td>glaz</td><td>Glazebury</td><td>53.46008</td><td>-2.472056</td><td>1998-2013</td></tr><tr><td>groningen</td><td>Groningen</td><td>53.40000</td><td>6.350000</td><td>2007-2013</td></tr><tr><td>har</td><td>Harwell</td><td>51.57108</td><td>-1.325283</td><td>1988-2013</td></tr><tr><td>hk</td><td>Hong Kong</td><td>22.29000</td><td>114.170000</td><td>1998-2013</td></tr><tr><td>hm</td><td>High Muffles</td><td>54.33500</td><td>-0.808600</td><td>1988-2013</td></tr><tr><td>kuwait</td><td>Kuwait City</td><td>29.36700</td><td>47.967000</td><td>2008-2013</td></tr><tr><td>lb</td><td>Ladybower</td><td>53.40337</td><td>-1.752006</td><td>1988-2013</td></tr><tr><td>london</td><td>Central London</td><td>51.50000</td><td>-0.100000</td><td>1990-2013</td></tr><tr><td>lh</td><td>Lullington Heath</td><td>50.79370</td><td>0.181250</td><td>1988-2013</td></tr><tr><td>ln</td><td>Lough Navar</td><td>54.43951</td><td>-7.900328</td><td>1988-2013</td></tr><tr><td>mh</td><td>Mace Head</td><td>53.33000</td><td>-9.900000</td><td>1988-2013</td></tr><tr><td>ny-alesund</td><td>Ny-Alesund, Norway</td><td>78.91763</td><td>11.894653</td><td>2009-2013</td></tr><tr><td>oslo</td><td>Oslo</td><td>59.90000</td><td>10.750000</td><td>2010-2013</td></tr><tr><td>paris</td><td>Paris, France</td><td>48.86200</td><td>2.339000</td><td>2000-2013</td></tr><tr><td>roch</td><td>Rochester Stoke</td><td>51.45617</td><td>0.634889</td><td>1988-2013</td></tr><tr><td>rotterdam</td><td>Rotterdam</td><td>51.91660</td><td>4.475000</td><td>2010-2013</td></tr><tr><td>saopaulo</td><td>Sao Paulo</td><td>-23.55000</td><td>-46.640000</td><td>2000-2013</td></tr><tr><td>sib</td><td>Sibton</td><td>52.29440</td><td>1.463970</td><td>1988-2013</td></tr><tr><td>sv</td><td>Strath Vaich</td><td>57.73446</td><td>-4.776583</td><td>1988-2013</td></tr><tr><td>wuhan</td><td>Wuhan, China</td><td>30.58300</td><td>114.280000</td><td>2008-2013</td></tr><tr><td>yw</td><td>Yarner Wood</td><td>50.59760</td><td>-3.716510</td><td>1988-2013</td></tr></table></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>Returns a data frame with pre-calculated back trajectories.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>This function imports pre-calculated back trajectories using the HYSPLIT
trajectory model (Hybrid Single Particle Lagrangian Integrated Trajectory
Model. Back trajectories provide some very useful information for air quality
data analysis. However, while they are commonly calculated by researchers it
is generally difficult for them to be calculated on a routine basis and used
easily. In addition, the availability of back trajectories over several years
can be very useful, but again difficult to calculate.</p>
<p>Trajectories are run at 3-hour intervals and stored in yearly files (see
below). The trajectories are started at ground-level (10m) and propagated
backwards in time.</p>
<p>These trajectories have been calculated using the Global NOAA-NCEP/NCAR
reanalysis data archives. The global data are on a latitude-longitude grid
(2.5 degree). Note that there are many different meteorological data sets
that can be used to run HYSPLIT e.g. including ECMWF data. However, in order
to make it practicable to run and store trajectories for many years and
sites, the NOAA-NCEP/NCAR reanalysis data is most useful. In addition, these
archives are available for use widely, which is not the case for many other
data sets e.g. ECMWF. HYSPLIT calculated trajectories based on archive data
may be distributed without permission. For those wanting, for example, to
consider higher resolution meteorological data sets it may be better to run
the trajectories separately.</p>
<p>We are extremely grateful to NOAA for making HYSPLIT available to produce
back trajectories in an open way. We ask that you cite HYSPLIT if used in
published work.</p>
<p>Users can supply their own trajectory files to plot in openair. These files
must have the following fields: date, lat, lon and hour.inc (see details
below).</p>
<p>The files consist of the following information:</p>
<dl><dt>date</dt>
<dd><p>This is the arrival point time and is repeated the
number of times equal to the length of the back trajectory --- typically 96
hours (except early on in the file). The format is <code>POSIXct</code>. It is this
field that should be used to link with air quality data. See example below.</p></dd>

<dt>receptor</dt>
<dd><p>Receptor number, currently only 1.</p></dd>
 <dt>year</dt>
<dd><p>The year</p></dd>

<dt>month</dt>
<dd><p>Month 1-12</p></dd>
 <dt>day</dt>
<dd><p>Day of the month 1-31</p></dd>
 <dt>hour</dt>
<dd><p>Hour
of the day 0-23 GMT</p></dd>
 <dt>hour.inc</dt>
<dd><p>Number of hours back in time e.g. 0 to
-96.</p></dd>
 <dt>lat</dt>
<dd><p>Latitude in decimal format.</p></dd>
  <dt>lon</dt>
<dd><p>Longitude in
decimal format.</p></dd>
  <dt>height</dt>
<dd><p>Height of trajectory (m).</p></dd>

<dt>pressure</dt>
<dd><p>Pressure of trajectory (kPa).</p></dd>
  
</dl></div>
    <div class="section level2">
    <h2 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a></h2>
    <p>The trajectories were run using the February 2011 HYSPLIT model.
The function is primarily written to investigate a single
site at a time for a single year. The trajectory files are quite
large and care should be exercised when importing several years and/or sites.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>Other import functions: 
<code><a href="importADMS.html">importADMS</a>()</code>,
<code><a href="importAQE.html">importAQE</a>()</code>,
<code><a href="importAURN.html">importAURN</a>()</code>,
<code><a href="importEurope.html">importEurope</a>()</code>,
<code><a href="importKCL.html">importKCL</a>()</code>,
<code><a href="importLocal.html">importLocal</a>()</code>,
<code><a href="importMeta.html">importMeta</a>()</code>,
<code><a href="importNI.html">importNI</a>()</code>,
<code><a href="importSAQN.html">importSAQN</a>()</code>,
<code><a href="importWAQN.html">importWAQN</a>()</code></p>
<p>Other trajectory analysis functions: 
<code><a href="trajCluster.html">trajCluster</a>()</code>,
<code><a href="trajLevel.html">trajLevel</a>()</code>,
<code><a href="trajPlot.html">trajPlot</a>()</code></p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>David Carslaw</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## import trajectory data for London in 2009</span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="va">mytraj</span> <span class="op">&lt;-</span> <span class="fu">importTraj</span><span class="op">(</span>site <span class="op">=</span> <span class="st">"london"</span>, year <span class="op">=</span> <span class="fl">2009</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## combine with measurements</span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="va">theData</span> <span class="op">&lt;-</span> <span class="fu"><a href="importAURN.html">importAURN</a></span><span class="op">(</span>site <span class="op">=</span> <span class="st">"kc1"</span>, year <span class="op">=</span> <span class="fl">2009</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">mytraj</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/merge.html" class="external-link">merge</a></span><span class="op">(</span><span class="va">mytraj</span>, <span class="va">theData</span>, by <span class="op">=</span> <span class="st">"date"</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in merge(mytraj, theData, by = "date"):</span> object 'mytraj' not found</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by David Carslaw, Jack Davison, Karl Ropkins.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

